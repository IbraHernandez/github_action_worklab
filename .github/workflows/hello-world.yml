name: Hello World with Context
run-name: '${{ (github.event.issue && format(''Issue #{0}'', github.event.issue.number)) || (github.event.schedule && ''Cron'') || github.actor }} triggered this workflow'
on:
  schedule:
    - cron: '0 9 * * *'
  workflow_dispatch:
    inputs:
      name:
        required: false
        description: 'Your name for personalized greeting'
        default: 'World'
        type: string
      greeting:
        required: false
        description: "Custom greeting message"
        default: "Hello"
        type: string
  issues:
    types: [opened]
jobs:
  hello:
    runs-on: ubuntu-latest
    steps:
      - name: ${{ github.actor }} triggered this workflow
        if: github.event_name == 'workflow_dispatch'
        run: |
          echo 'Hello, ${{ inputs.name }}'
          echo 'Triggered by: ${{ github.actor }}'
          echo 'Repository: ${{ github.repository }}'
          echo 'Reference: ${{ github.ref }}'
        env:
          NAME: ${{ github.event.inputs.name }}
          GREETING: ${{ github.event.inputs.greeting }}
          REF: ${{ github.ref }}

      - name: Issue ${{ github.event.issue.number }} triggered this workflow
        if: github.event_name == 'issues'
        run: |
            echo "New issue opened!"
            echo "Issue #${{ github.event.issue.number }}: $ISSUE_TITLE"
            echo "Body: $ISSUE_BODY"
            echo "Opened by: ${{ github.event.issue.user.login }}"
            echo "Issue URL: ${{ github.event.issue.html_url }}"
        env:
            ISSUE_TITLE: ${{ github.event.issue.title }}
            ISSUE_BODY: ${{ github.event.issue.body }}

      - name: Cron triggered this workflow
        if: github.event_name == 'schedule'
        run: |
          echo "Daily status check - All systems operational"
          echo -n "Current time: "; date -u
        env:
          ISSUE_TITLE: ${{ github.event.issue.title }}
          ISSUE_BODY: ${{ github.event.issue.body }}

          

  github_cli:
    runs-on: ubuntu-latest
    permissions: write-all
    steps:
      - name: Comment the issue
        if: github.event_name == 'issues'
        run: |
          gh issue comment ${{ github.event.issue.number }} --repo ${{ github.repository }}  --body "Hello to may issue from github CLI"
          echo "Comment added to issue ${{ github.event.issue.number }}"
        env:
          GH_TOKEN: ${{ github.token }}

      - name: On schedule
        if: github.event_name == 'workflow_dispatch'
        run: |
          echo "${{ github }}"
          echo "Recent workflow runs:"
          gh run list --workflow hello-world.yml --repo ${{ github.repository }}
        env:
          GH_TOKEN: ${{ github.token }}

      - name: On workload_dispatch
        if: github.event_name == 'workflow_dispatch'
        run: |
          echo "Repo Info!"
          echo "Name: ${{ github.repository }}"
          echo "Owner: ${{ github.repository_owner }}"